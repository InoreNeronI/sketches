{"mappings":"","sources":["src/mario/minim.js"],"sourcesContent":["/**\n * Minim-emulation code by Daniel Hodgin\n */\n\n// wrap the P5 Minim sound library classes\nfunction Minim() {\n  this.loadFile = function (str) {\n    return new AudioPlayer(str);\n  };\n}\n\n// Browser Audio API\nfunction AudioPlayer(str) {\n  const audio = document.createElement('audio');\n  let loaded = false;\n  let looping = false;\n\n  if (document.createElement('audio').canPlayType) {\n    audio.addEventListener(\n      'ended',\n      async function () {\n        if (looping) {\n          this.currentTime = 0;\n          await this.play();\n        }\n      },\n      false,\n    );\n    audio.preload = 'auto';\n    audio.autobuffer = true;\n    if (canPlayOgg()) {\n      audio.src = str.substring(0, str.lastIndexOf('.')) + '.ogg';\n    } else if (canPlayMp3()) {\n      audio.src = str;\n    }\n    loaded = true;\n  }\n  this.play = async function () {\n    if (!loaded || audio.readyState === 0) {\n      const local = this;\n      setTimeout(function () {\n        local.play();\n      }, 50);\n      return;\n    }\n    await audio.play();\n  };\n  this.loop = async function () {\n    if (!loaded || audio.readyState === 0) {\n      const local = this;\n      setTimeout(function () {\n        local.loop();\n      }, 50);\n      return;\n    }\n    //audio.loop = 'loop';\n    looping = true;\n    await audio.play();\n  };\n  this.pause = function () {\n    if (!loaded) {\n      return;\n    }\n    audio.pause();\n  };\n  this.rewind = function () {\n    if (!loaded || audio.readyState === 0) {\n      return;\n    }\n    // rewind the sound to start\n    audio.currentTime = 0;\n  };\n}\n\nfunction canPlayOgg() {\n  const a = document.createElement('audio');\n  return !!(a.canPlayType && a.canPlayType('audio/ogg; codecs=\"vorbis\"').replace(/no/, ''));\n}\n\nfunction canPlayMp3() {\n  const a = document.createElement('audio');\n  return !!(a.canPlayType && a.canPlayType('audio/mpeg;').replace(/no/, ''));\n}\n"],"names":[],"version":3,"file":"index.d53dd57c.js.map"}