{"mappings":"","sources":["src/supratetris/index.js"],"sourcesContent":["// https://coolors.co/242331-533e2d-a27035-b88b4a-ddca7d\n\nlet palette = {\n  white: '#DDCA7D',\n  light: '#B88B4A',\n  mid: '#A27035',\n  dark: '#533E2D',\n  black: '#242331',\n  blacker: '#1B1924',\n  blackest: '#16151E',\n  mote: '#322C44',\n};\n\nlet grid;\nlet targets = [];\nlet fallingCells = [];\nlet motes = [];\n\nlet cellSize = 40;\n\nlet score = -1;\n\nlet images = {};\nlet sounds = {};\nlet soundIndexes = {};\n\nlet fudgeFont;\n\nlet interacted = false;\n\nfunction preload() {\n  images.tile = {};\n\n  images.tile.deselected = loadImage('../assets/supratetris/images/tile-deselected.png');\n  images.tile.selected = loadImage('../assets/supratetris/images/tile-selected.png');\n\n  images.tile.blue = loadImage('../assets/supratetris/images/tile-cyan.png');\n  images.tile.cyan = loadImage('../assets/supratetris/images/tile-green.png');\n  images.tile.green = loadImage('../assets/supratetris/images/tile-orange.png');\n  images.tile.orange = loadImage('../assets/supratetris/images/tile-purple.png');\n  images.tile.purple = loadImage('../assets/supratetris/images/tile-red.png');\n  images.tile.red = loadImage('../assets/supratetris/images/tile-yellow.png');\n  images.tile.yellow = loadImage('../assets/supratetris/images/tile-blue.png');\n\n  images.background = loadImage('../assets/supratetris/images/background.png');\n\n  fudgeFont = loadFont('../assets/supratetris/DarumadropOne-Regular.ttf');\n\n  sounds.rerollButton = [];\n  soundIndexes.rerollButton = 0;\n  for (let i = 0; i < 6; i++) {\n    sounds.rerollButton.push(new Audio('../assets/supratetris/sounds/reroll-button.ogg'));\n  }\n\n  sounds.completeShape = [];\n  soundIndexes.completeShape = 0;\n  for (let i = 0; i < 6; i++) {\n    sounds.completeShape.push(new Audio('../assets/supratetris/sounds/complete-shape.ogg'));\n  }\n\n  sounds.incompleteShape = [];\n  soundIndexes.incompleteShape = 0;\n  for (let i = 0; i < 6; i++) {\n    sounds.incompleteShape.push(new Audio('../assets/supratetris/sounds/incomplete-shape.ogg'));\n  }\n\n  sounds.selectBlock = [];\n  for (let i = 1; i <= 3; i++) {\n    sounds.selectBlock.push(new Audio('../assets/supratetris/sounds/select-block-' + i + '.ogg'));\n  }\n\n  sounds.deselectBlock = [];\n  soundIndexes.deselectBlock = 0;\n  for (let i = 0; i < 6; i++) {\n    sounds.deselectBlock.push(new Audio('../assets/supratetris/sounds/deselect-block.ogg'));\n  }\n\n  sounds.music = new Audio('../assets/supratetris/sounds/music.ogg');\n  sounds.music.loop = true;\n}\n\nfunction setup() {\n  for (let colour in palette) {\n    palette[colour] = color(palette[colour]);\n  }\n\n  targetShapes = [\n    [\n      images.tile.cyan,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 1, 0, 0],\n      ],\n    ],\n    [\n      images.tile.cyan,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 1, 0, 0],\n      ],\n    ],\n    [\n      images.tile.cyan,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n        [0, 1, 1, 1, 1],\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.cyan,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n        [0, 1, 1, 1, 1],\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.red,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n        [0, 1, 1, 0, 0],\n        [0, 0, 1, 1, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.green,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 1, 0],\n        [0, 1, 1, 0, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.red,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 1, 1, 0, 0],\n        [0, 1, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.green,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 1, 1, 0],\n        [0, 0, 0, 1, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.red,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n        [0, 1, 1, 0, 0],\n        [0, 0, 1, 1, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.green,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 1, 0],\n        [0, 1, 1, 0, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.red,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 1, 1, 0, 0],\n        [0, 1, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.green,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 1, 1, 0],\n        [0, 0, 0, 1, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.yellow,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 1, 0],\n        [0, 0, 1, 1, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.yellow,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 1, 0],\n        [0, 0, 1, 1, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.yellow,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 1, 0],\n        [0, 0, 1, 1, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.yellow,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 1, 0],\n        [0, 0, 1, 1, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.purple,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n        [0, 1, 1, 1, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.purple,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 1, 1, 1, 0],\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.purple,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 1, 1, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.purple,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 1, 1, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.orange,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 1, 1, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.blue,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 1, 1, 0, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.blue,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 1, 0, 0, 0],\n        [0, 1, 1, 1, 0],\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.orange,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 1, 0],\n        [0, 1, 1, 1, 0],\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.orange,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n        [0, 1, 1, 1, 0],\n        [0, 1, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.blue,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n        [0, 1, 1, 1, 0],\n        [0, 0, 0, 1, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.blue,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 0, 1, 1, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n    [\n      images.tile.orange,\n      [\n        [0, 0, 0, 0, 0],\n        [0, 1, 1, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 0, 0, 0],\n      ],\n    ],\n  ];\n\n  const myCanvas = createCanvas(1440, 815);\n  myCanvas.parent('Supratetris');\n  rectMode(CENTER);\n  imageMode(CENTER);\n  textFont(fudgeFont);\n  textAlign(CENTER, CENTER);\n\n  targetBubble = new TargetBubble();\n\n  for (let i = 0; i < 50; i++) {\n    motes.push(new Mote());\n  }\n\n  setupButtons();\n  newGame();\n}\n\nfunction setupButtons() {\n  let respinButton = select('#respin-button');\n  let buttonX = windowWidth / 2 - 400 - 120;\n  let buttonY = windowHeight / 2 - 303;\n  respinButton.style('transform', 'translate(' + buttonX + 'px,' + buttonY + 'px)');\n  respinButton.style('display', 'inline');\n  respinButton.mousePressed(respin);\n}\n\nfunction newGame() {\n  grid = new Grid(10, 14, cellSize);\n  grid.createGrid();\n  grid.updateScore();\n  targets = [];\n\n  for (let i = 0; i < 3; i++) {\n    targets.push(new Target(cellSize, i));\n  }\n}\n\nfunction draw() {\n  update();\n  display();\n  displayUI();\n}\n\nfunction update() {\n  grid.update();\n  targetBubble.update();\n\n  for (let i = 0; i < targets.length; i++) {\n    targets[i].update();\n  }\n\n  for (let i = 0; i < fallingCells.length; i++) {\n    fallingCells[i].update();\n  }\n\n  for (let i = 0; i < motes.length; i++) {\n    motes[i].update();\n  }\n}\n\nfunction display() {\n  image(images.background, width / 2, height / 2, width, height);\n\n  for (let i = 0; i < motes.length; i++) {\n    motes[i].display();\n  }\n\n  grid.display();\n  targetBubble.display();\n\n  for (let i = 0; i < targets.length; i++) {\n    targets[i].display();\n  }\n\n  for (let i = 0; i < fallingCells.length; i++) {\n    fallingCells[i].display();\n  }\n}\n\nfunction displayUI() {\n  push();\n  translate(width / 2 + 420, height / 2 - 200);\n\n  fill(palette.blacker);\n  stroke(palette.blackest);\n  strokeWeight(5);\n  rect(0, 0, 270, 200, 40);\n\n  fill(palette.white);\n  textSize(30);\n  text('lowest score', 0, -40);\n  textSize(60);\n  text(score, 0, 5);\n\n  pop();\n\n  fill(palette.white);\n  textSize(30);\n}\n\nfunction mousePressed() {\n  if (grid.hover()) {\n    if (grid.validate()) {\n      grid.dropSelected();\n      grid.updateScore();\n      playSoundFromArray('completeShape');\n    }\n  }\n}\n\nfunction keyPressed() {\n  if (key === 'R' || key === 'r') {\n    respin();\n  }\n}\n\nfunction respin() {\n  for (let i = 0; i < targets.length; i++) {\n    targets[i].newShape();\n  }\n  grid.addNewRow();\n  grid.clearSelected();\n\n  playSoundFromArray('rerollButton');\n}\n\nfunction playSoundFromArray(name) {\n  sounds[name][soundIndexes[name]].play();\n  soundIndexes[name]++;\n  if (soundIndexes[name] >= sounds[name].length) soundIndexes[name] = 0;\n  return soundIndexes[name];\n}\n"],"names":[],"version":3,"file":"index.40ffa8f9.js.map"}